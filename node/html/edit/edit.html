<!DOCTYPE html>
<html>
  <head>
    <script src="jquery.min.js"></script>
    <script src="/socket.io/socket.io.js"></script>
  </head>
  <body>
    <table border="1" rules="rows">
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Votacion 1: Paro CONFECH Jueves</b>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>SI</b>
        </td>
        <td>
          <div id="vote_1_si" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:1,si_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:1', 'si')">+1</button>
        </td>
        <td>
          <button id="vote:1,si_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:1', 'si')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>NO</b>
        </td>
        <td>
          <div id="vote_1_no" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:1,no_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:1', 'no')">+1</button>
        </td>
        <td>
          <button id="vote:1,no_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:1', 'no')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Blanco</b>
        </td>
        <td>
          <div id="vote_1_blancos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:1,blanco_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:1', 'blancos')">+1</button>
        </td>
        <td>
          <button id="vote:1,blanco_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:1', 'blancos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Nulo</b>
        </td>
        <td>
          <div id="vote_1_nulos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:1,nulo_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:1', 'nulos')">+1</button>
        </td>
        <td>
          <button id="vote:1,nulo_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:1', 'nulos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Votacion 2: Vocería CONFECH Estatal</b>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>SI</b>
        </td>
        <td>
          <div id="vote_2_si" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:2,si_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:2', 'si')">+1</button>
        </td>
        <td>
          <button id="vote:2,si_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:2', 'si')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>NO</b>
        </td>
        <td>
          <div id="vote_2_no" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:2,no_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:2', 'no')">+1</button>
        </td>
        <td>
          <button id="vote:2,no_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:2', 'no')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Blanco</b>
        </td>
        <td>
          <div id="vote_2_blancos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:2,blanco_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:2', 'blancos')">+1</button>
        </td>
        <td>
          <button id="vote:2,blanco_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:2', 'blancos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Nulo</b>
        </td>
        <td>
          <div id="vote_2_nulos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:2,nulo_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:2', 'nulos')">+1</button>
        </td>
        <td>
          <button id="vote:2,nulo_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:2', 'nulos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Votacion 3: Vocería CONFECH Privadas</b>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>SI</b>
        </td>
        <td>
          <div id="vote_3_si" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:3,si_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:3', 'si')">+1</button>
        </td>
        <td>
          <button id="vote:3,si_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:3', 'si')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>NO</b>
        </td>
        <td>
          <div id="vote_3_no" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:3,no_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:3', 'no')">+1</button>
        </td>
        <td>
          <button id="vote:3,no_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:3', 'no')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Blanco</b>
        </td>
        <td>
          <div id="vote_3_blancos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:3,blanco_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:3', 'blancos')">+1</button>
        </td>
        <td>
          <button id="vote:3,blanco_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:3', 'blancos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
          <b>Nulo</b>
        </td>
        <td>
          <div id="vote_3_nulos" style="width:40px;font-size:20pt;">0</div>
        </td>
        <td>
          <button id="vote:3,nulo_upvote" style="width:40px;font-size:20pt;" onclick="upvote('votes:3', 'nulos')">+1</button>
        </td>
        <td>
          <button id="vote:3,nulo_downvote" style="width:40px;font-size:20pt;" onclick="downvote('votes:3', 'nulos')">-1</button>
        </td>
      </tr>
      <tr>
        <td style="width:1px;"></td>
        <td style="">
        </td>
        <td>
          <button type="button" style="font-size:15pt;" onclick="updateStatus()">Actualizar Texto</button>
        </td>
      </tr>
    </table>
    <textarea id="status_msg" name="status_msg"></textarea>             
    <script>
      var socket = io.connect('http://localhost:8080');

      socket.on('connect', function(){
        socket.emit('addstream');
      });

      socket.on('update_counts', function (votes_1, votes_2, votes_3) {
        console.log("Received update")
        for (var choice in votes_1) {
          $('#vote_1_'+choice).empty();
          $('#vote_1_'+choice).append(votes_1[choice]);
        }
        for (var choice in votes_2) {
          $('#vote_2_'+choice).empty();
          $('#vote_2_'+choice).append(votes_2[choice]);
        }
        for (var choice in votes_3) {
          console.log(choice);
          $('#vote_3_'+choice).empty();
          $('#vote_3_'+choice).append(votes_3[choice]);
        }
      });

      socket.on('update_status', function (msg) {
        $('#status_msg').val(msg);
      })

      function upvote(poll, choice) {
        socket.emit('upvote', poll, choice);
      }
      function downvote(poll, choice) {
        socket.emit('downvote', poll, choice);
      }
      function updateStatus() {
        socket.emit('update_status', $('#status_msg').val());
      }
    </script>
  </body>
</html>
